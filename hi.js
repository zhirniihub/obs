"use strict";const ch=require("chalk"),Color=require("color-regex"),defaultBgTextColor="black",defaultSymbols={trace:"??",success:"√",ok:"√",debug:"i",info:"i",warning:"‼",warn:"‼",error:"\xd7"},terminalColors={trace:"#3C9DFF",trace_:"#3C9DFF",success:"#26FF5C",success_:"#26FF5C",ok:"#26FF5C",ok_:"#26FF5C",debug:"#34DADA",debug_:"#34DADA",info:"#3C9DFF",info_:"#3C9DFF",warning:"#FFC926",warning_:"#FFC926",warn:"#FFC926",warn_:"#FFC926",error:"#F55256",error_:"#F55256"},browserColors={trace:"#3C9DFF",trace_:"#3C9DFF",success:"#008000",success_:"#5AFB78",ok:"#008000",ok_:"#5AFB78",debug:"#07AABC",debug_:"#80FCFF",info:"#0151B1",info_:"#80C6FF",warning:"#BB8404",warning_:"#FFD280",warn:"#BB8404",warn_:"#FFD280",error:"#E60000",error_:"#F55256"},LOG_TEXT="TEXT",LOG_BG="BG";class LogBeautify{constructor(){this.useSymbols=!0,this.useLabels=!1,this.defaultSymbol="!",this.defaultLevel=1,this._localLevels={},this._namespaceLevels={},this._namespaces={},this._globalLevel=1,this._stackTracer=new StackTracer,this._levels={silent:-1,trace:0,success:1,ok:1,debug:2,info:3,warning:4,warn:4,error:5},this._colors=this._isBrowser()?browserColors:terminalColors,this._bgTextColors={trace_:"black",success_:"black",ok_:"black",debug_:"black",info_:"black",warning_:"black",warn_:"black",error_:"white"},this._symbols=this._useUnicodeSymbols()?{trace:"⁇",success:"✔",ok:"✔",debug:"ℹ",info:"\uD83D\uDEC8",warning:"⚠",warn:"⚠",error:"✖"}:defaultSymbols,this._labels={trace:"TRACE",success:"SUCCESS",ok:"OK",debug:"DEBUG",info:"INFO",warning:"WARNING",warn:"WARNING",error:"ERROR"},this._createLogs()}show(...e){this._shouldLog(this.getWorkingLevel())&&console.log(...e)}setLevel(e,t="global"){let s=null!==this._parseLevel(e)?this._parseLevel(e):this._globalLevel;"global"===t?this._globalLevel=s:this.setNamespaceLevel(s,t)}setLocalLevel(e){let t=this._parseLevel(e);null!==t&&this._callerFile()&&(this._localLevels[this._callerFile()]=t)}setNamespaceLevel(e,t=null){let s=this._parseLevel(e);null!==s&&null!==t&&(this._namespaceLevels[t]=s,this.useNamespace(t))}useNamespace(e=null){null!==e&&this._callerFile()&&(this._namespaces[this._callerFile()]=e)}namespace(e=null){this.useNamespace(e)}getWorkingLevel(){let e=this._callerFile();if(e&&void 0!==this._localLevels[e])return this._localLevels[e];let t=this._namespaces[e];return void 0!==t&&void 0!==this._namespaceLevels[t]?this._namespaceLevels[t]:this._globalLevel}setLevels(e){Object.keys(e).map(t=>{let s=this._parseLevel(e[t]);return null!==s&&(this._levels[t]=s),t})}setColors(e){this._colors={...this._colors,...e},this._createLogs()}setTextColors(e){this._bgTextColors={...this._bgTextColors,...e}}setSymbols(e){this._symbols={...this._symbols,...e}}setLabels(e){this._labels={...this._labels,...e}}_useUnicodeSymbols(){let e=process.env;return this._isBrowser()||"win32"!==process.platform||e.CI||e.TERM||e.TERM_PROGRAM}_createLogs(){Object.keys(this._colors).map(e=>(e.lastIndexOf("_")===e.length-1?this._createBgLog(e):this._createTextLog(e),e))}_getSymbol(e){return this._symbols[e]||this._symbols[this._getKeyName(e)]||this.defaultSymbol}_getLabel(e){return this._labels[e]||this._labels[this._getKeyName(e)]||""}_createTextLog(e){LogBeautify.prototype[e]||(LogBeautify.prototype[e]=function(...t){this._log(LOG_TEXT,e,t)})}_createBgLog(e){LogBeautify.prototype[e]||(LogBeautify.prototype[e]=function(...t){this._log("BG",e,t)})}_log(e,t,s){let r=this._getKeyLevel(t);this._shouldLog(r)&&("trace"===this._getKeyName(t)?console.trace(...s):(s=this._parseArgs(s),this._isBrowser()?this._logBrowser(e,t,s):this._logTerminal(e,t,s)))}_logBrowser(e,t,s){if(!isArray(s)){console.log(s);return}let r,l=this._getPrefix(e,t);r=e===LOG_TEXT?this._getCSS("BG",t+"_"):this._getCSS(LOG_TEXT,this._getKeyName(t)),l?this.useLabels?console.log("%c%s"+this._formatLogBrowser(t,s),r,l,this._getCSS(e,t),...s):(s.unshift(this._getSymbolString(t,e===LOG_TEXT?"":" ","")),console.log(this._formatLogBrowser(t,s),this._getCSS(e,t),...s)):console.log(this._formatLogBrowser(t,s),this._getCSS(e,t),...s)}_logTerminal(e,t,s){let r,l,i;e===LOG_TEXT&&(this._getPrefix(e,t)&&!this.useLabels&&s.unshift(this._getSymbolString(t,"","")),i=r=this._chTextColor(this._colors[t])(...this._fixArgs(s,t)),this._getPrefix(e,t)&&this.useLabels?console.log(this._getPrefix(e,t),i):console.log(i)),"BG"===e&&(r=this._chTextColor(this._bgTextColors[t]||defaultBgTextColor),l=this._chBgColor(this._colors[t]),this._getPrefix(e,t)&&!this.useLabels&&s.unshift(this._getSymbolString(t," ","")),i=l(r(...this._fixArgs(s,t))),this._getPrefix(e,t)&&this.useLabels?console.log(this._getPrefix(e,t),i):console.log(i))}_getPrefix(e,t){let s=this._getSymbolAndLabel(e,t);return s.success?s.payload:""}_getSymbolString(e,t=" ",s=" "){return this.useSymbols&&this._getSymbol(e)?t+this._getSymbol(e)+s:""}_getLabelString(e,t=" ",s=" "){return this.useLabels&&this._getLabel(e)?t+this._getLabel(e)+s:""}_getSymbolAndLabel(e,t){let s="",r=this._getSymbolString(t," "," "),l=r?this._getLabelString(t,""):this._getLabelString(t);if(!r&&!l)return{success:!1,payload:s};if(this._isBrowser())s=r+l;else{if(e===LOG_TEXT){let i=this._chTextColor(this._bgTextColors[t+"_"]||defaultBgTextColor),o=this._chBgColor(this._colors[t+"_"]);s=o("info"===t&&" \uD83D\uDEC8 "==r?i(r+l+" "):i(r+l))}"BG"===e&&(s=this._chTextColor(this._colors[this._getKeyName(t)])(r+l))}return{success:!0,payload:s}}_fixArgs(e,t){let s=[];return("info"===t||"info_"===t)&&e.push(""),e.map(e=>(isArray(e)?(s.push("["),s.push(e),s.push("]")):s.push(e),e)),s}_formatLogBrowser(e,t){let s=this._getLabelString(e)?"%c ":"%c";return t.map(e=>("string"==typeof e?s+="%s ":"number"==typeof e?s+="%d ":"object"==typeof e?s+="%o":s+="%s ",e)),s.trim()}_getCSS(e,t){let s="",r,l;return e===LOG_TEXT&&(s+="color: "+(r=this._colors[t])),"BG"===e&&(r=this._bgTextColors[t]||defaultBgTextColor,l=this._colors[t],s+="color: "+r,s+="; background-color: "+l),s}_shouldLog(e){let t=this.getWorkingLevel(),s=t>this._levels.silent&&e>=t;return(!process.env||!process.env.NODE_ENV||"dev"===process.env.NODE_ENV||"development"===process.env.NODE_ENV)&&s}_getKeyLevel(e){let t=this._getKeyName(e);return void 0!==this._levels[t]?this._levels[t]:this.defaultLevel}_getKeyName(e){return e.lastIndexOf("_")===e.length-1?e.substring(0,e.length-1):e}_chBase(){return ch}_chTextColor(e){let t=Color.getFormat(e);switch(t){case"hex":return this._chBase().hex(e);case"rgb":return this._chBase().rgb(...Color.toArray(e,!0));case"hsl":return this._chBase().hsl(...Color.toArray(e,!0));case"hsv":return this._chBase().hsv(...Color.toArray(e,!0));case"hwb":return this._chBase().hwb(...Color.toArray(e,!0));default:return validKeywords.indexOf(e)>=0?this._chBase().keyword(e):this._chBase()}}_chBgColor(e){let t=Color.getFormat(e);switch(t){case"hex":return ch.bgHex(e);case"rgb":return ch.bgRgb(...Color.toArray(e,!0));case"hsl":return ch.bgHsl(...Color.toArray(e,!0));case"hsv":return ch.bgHsv(...Color.toArray(e,!0));case"hwb":return ch.bgHwb(...Color.toArray(e,!0));default:return validKeywords.indexOf(e)>=0?ch.bgKeyword(e):ch}}_parseLevel(e){return!isNaN(parseInt(e))&&e>=this._levels.silent?parseInt(e):"string"==typeof e&&void 0!==this._levels[e.toLowerCase()]?this._levels[e.toLowerCase()]:null}_callerFile(){let e=this._stackTracer.getInfo();return e.callerFile?e.callerFile:null}_isBrowser(){return"undefined"!=typeof window&&void 0!==window.document}_parseArgs(e){return e.map(e=>this._isBrowser()?e:isObject(e)?JSON.stringify(e,null,3):isArray(e)?this._parseArgs(e):e)}}const isArray=e=>!!e&&e.constructor===Array,isObject=e=>!!e&&e.constructor===Object;class StackTracer{constructor(){this._isVue=!1,this.traces={webpack:["__webpack_require__",],react:["constructClassInstance","finishClassComponent","commitLifeCycles","mountIndeterminateComponent","updateFunctionComponent"]}}isNode(){return"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node}isBrowser(){return"undefined"!=typeof window&&void 0!==window.document}isReact(){try{return!!window.webpackJsonp[0][0]}catch(e){return!1}}isVue(e){return -1!==e.indexOf("Module")&&-1!==e.indexOf("/vue-loader/")&&(this._isVue=!0),this._isVue}getReactImports(){let e=[];try{for(let t in window.webpackJsonp[1][1])e.push(t)}catch(s){}return e}getInfo(){let e=Error.prepareStackTrace,t,s,r=null,l=null,i=null;try{Error.prepareStackTrace=function(e,t){return t};var o=Error().stack;if(this.isNode()){for(let a in s=o.shift().getFileName(),o)if(o.hasOwnProperty(a)&&(r=o[a].getFileName(),s!==r)){l=o[a].getLineNumber(),i=o[a].getFunctionName();break}}else if(this.isBrowser())for(let n in o){if(!o.hasOwnProperty(n))continue;let h=o[n].toString(),g=h.split(" ")[0];if(-1!==this.traces.webpack.indexOf(g)||-1!==this.traces.react.indexOf(g)){if(t=o[n-1].toString(),this.isReact()){if(r=-1!==t.indexOf("Module")?t.split(" ")[0].replace("Module",""):0===t.indexOf("new")?t.split(" ")[1]:t.split(".")[0],!/\.(js|jsx)$/gi.test(r)){let c=r,u=this.getReactImports().find(e=>-1!==e.indexOf(c+".js",e.length-(c+".js").length)||-1!==e.indexOf(c+".jsx",e.length-(c+".jsx").length));r="."+u}}else if(this.isVue(t)&&-1!==t.indexOf("Module")){if(-1!==t.indexOf("/vue-loader/")&&-1!==t.indexOf(".vue?vue")){let d=t.split(".js?!");d.length&&(r=d[d.length-1].split("?vue")[0])}else r=t.split(" ")[0].replace("Module","")}i=r,l=o[n-1].getLineNumber();break}}}catch(b){}return Error.prepareStackTrace=e,{callerFile:r,lineNumber:l,functionName:i}}}const validKeywords=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"];module.exports=new LogBeautify;
